const a2_0x30da=['get','then','reduce','__esModule','__awaiter','statuses','defineProperty','axiosException','note','indexOf','storeRequests','messages','value','cache-miss','waitForStoreRequestsToComplete','retrieve','cacheError','../../../utilities/nx-imports','hashUrls','put','store','../../../utilities/environment','VERBOSE_LOGGING','apply','remote-cache-hit','requests','NX_CLOUD_DISTRIBUTED_EXECUTION_ID','push','filter','forEach','next','done','startRun','response','hash','all','Nx\x20Cloud:\x20Cache\x20miss\x20','fileStorage','extractErrorMessage','CloudRemoteCache','throw','storage','runContext','api'];(function(_0x2ff4d3,_0x30da03){const _0x2f09e9=function(_0x14f756){while(--_0x14f756){_0x2ff4d3['push'](_0x2ff4d3['shift']());}};_0x2f09e9(++_0x30da03);}(a2_0x30da,0x12d));const a2_0x2f09=function(_0x2ff4d3,_0x30da03){_0x2ff4d3=_0x2ff4d3-0x0;let _0x2f09e9=a2_0x30da[_0x2ff4d3];return _0x2f09e9;};'use strict';var __awaiter=this&&this[a2_0x2f09('0xb')]||function(_0x5856e1,_0x38569e,_0x1c8458,_0x19e867){function _0x566b10(_0x2fbda6){return _0x2fbda6 instanceof _0x1c8458?_0x2fbda6:new _0x1c8458(function(_0x4e1548){_0x4e1548(_0x2fbda6);});}return new(_0x1c8458||(_0x1c8458=Promise))(function(_0x544ebc,_0xc05833){function _0x43df0a(_0x1e506b){try{_0xf56b27(_0x19e867[a2_0x2f09('0x25')](_0x1e506b));}catch(_0x5a97b7){_0xc05833(_0x5a97b7);}}function _0x35912e(_0x5bc0ec){try{_0xf56b27(_0x19e867[a2_0x2f09('0x3')](_0x5bc0ec));}catch(_0x71aa8d){_0xc05833(_0x71aa8d);}}function _0xf56b27(_0x2ae161){_0x2ae161[a2_0x2f09('0x26')]?_0x544ebc(_0x2ae161[a2_0x2f09('0x13')]):_0x566b10(_0x2ae161[a2_0x2f09('0x13')])[a2_0x2f09('0x8')](_0x43df0a,_0x35912e);}_0xf56b27((_0x19e867=_0x19e867[a2_0x2f09('0x1e')](_0x5856e1,_0x38569e||[]))[a2_0x2f09('0x25')]());});};Object[a2_0x2f09('0xd')](exports,a2_0x2f09('0xa'),{'value':!![]});exports[a2_0x2f09('0x2')]=void 0x0;const environment_1=require(a2_0x2f09('0x1c'));const {output}=require(a2_0x2f09('0x18'));class CloudRemoteCache{constructor(_0x24ac0b,_0x26422b,_0x5326d0,_0x22d404){this[a2_0x2f09('0x12')]=_0x24ac0b;this[a2_0x2f09('0x6')]=_0x26422b;this[a2_0x2f09('0x5')]=_0x5326d0;this['fileStorage']=_0x22d404;this[a2_0x2f09('0x11')]=[];}[a2_0x2f09('0x16')](_0x51dcdd,_0xe76ea8){var _0x2ac107;return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a2_0x2f09('0x12')][a2_0x2f09('0x17')])return![];const _0x2538a7=yield this[a2_0x2f09('0x19')](_0x51dcdd);if(!_0x2538a7||!_0x2538a7[a2_0x2f09('0x7')]){if(environment_1['VERBOSE_LOGGING']){output[a2_0x2f09('0xf')]({'title':a2_0x2f09('0x2b')+_0x51dcdd+'.'});}this[a2_0x2f09('0x5')][a2_0x2f09('0xc')][_0x51dcdd]='cache-miss';return![];}try{yield this[a2_0x2f09('0x0')][a2_0x2f09('0x16')](_0x51dcdd,_0x2538a7['get'],_0xe76ea8);this[a2_0x2f09('0x5')][a2_0x2f09('0xc')][_0x51dcdd]=a2_0x2f09('0x1f');return!![];}catch(_0x41d185){const _0x4a252f=(_0x2ac107=_0x41d185[a2_0x2f09('0xe')])!==null&&_0x2ac107!==void 0x0?_0x2ac107:_0x41d185;if(_0x4a252f[a2_0x2f09('0x28')]&&_0x4a252f['response']['status']===0x194){if(environment_1[a2_0x2f09('0x1d')]){output[a2_0x2f09('0xf')]({'title':'Nx\x20Cloud:\x20Cache\x20miss\x20'+_0x51dcdd+'.\x20Status\x20404.'});}}else{this[a2_0x2f09('0x12')][a2_0x2f09('0x17')]=this['messages']['extractErrorMessage'](_0x4a252f,a2_0x2f09('0x4'));}this['runContext'][a2_0x2f09('0xc')][_0x51dcdd]=a2_0x2f09('0x14');return![];}});}['store'](_0x2c9c14,_0x2f4e67){return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a2_0x2f09('0x12')][a2_0x2f09('0x17')])return![];const _0x46133b=Promise['resolve']()[a2_0x2f09('0x8')](()=>__awaiter(this,void 0x0,void 0x0,function*(){var _0x379bcf;const _0x543a97=yield this['hashUrls'](_0x2c9c14);if(!_0x543a97)return![];if(!_0x543a97[a2_0x2f09('0x1a')]){if(environment_1[a2_0x2f09('0x1d')]){output[a2_0x2f09('0xf')]({'title':'Nx\x20Cloud:\x20Skipping\x20storing\x20'+_0x2c9c14+'.\x20Read\x20only\x20token\x20is\x20used.'});}return!![];}try{yield this[a2_0x2f09('0x0')][a2_0x2f09('0x1b')](_0x2c9c14,_0x543a97[a2_0x2f09('0x1a')],_0x2f4e67);return!![];}catch(_0x51c38f){const _0x563039=(_0x379bcf=_0x51c38f[a2_0x2f09('0xe')])!==null&&_0x379bcf!==void 0x0?_0x379bcf:_0x51c38f;this['messages'][a2_0x2f09('0x17')]=this['messages'][a2_0x2f09('0x1')](_0x563039,a2_0x2f09('0x4'));return![];}}));this['storeRequests'][a2_0x2f09('0x22')](_0x46133b);return _0x46133b;});}['hashUrls'](_0x1fbde2){return __awaiter(this,void 0x0,void 0x0,function*(){if(_0x1fbde2 in this[a2_0x2f09('0x5')][a2_0x2f09('0x20')]){return(yield this[a2_0x2f09('0x5')][a2_0x2f09('0x20')][_0x1fbde2])[_0x1fbde2];}else{const _0x2a2fd4=this[a2_0x2f09('0x5')]['scheduledTasks'][a2_0x2f09('0x23')](_0x50a4c2=>!this['runContext'][a2_0x2f09('0x20')][_0x50a4c2[a2_0x2f09('0x29')]])['map'](_0x35d77e=>_0x35d77e[a2_0x2f09('0x29')]);if(_0x2a2fd4[a2_0x2f09('0x10')](_0x1fbde2)===-0x1){_0x2a2fd4['push'](_0x1fbde2);}const _0x1c8856=this[a2_0x2f09('0x6')][a2_0x2f09('0x27')](environment_1[a2_0x2f09('0x21')],_0x2a2fd4);_0x2a2fd4[a2_0x2f09('0x24')](_0x9661eb=>{this[a2_0x2f09('0x5')]['requests'][_0x9661eb]=_0x1c8856;});return(yield _0x1c8856)[_0x1fbde2];}});}[a2_0x2f09('0x15')](){return Promise[a2_0x2f09('0x2a')](this[a2_0x2f09('0x11')])[a2_0x2f09('0x8')](_0x37c17a=>_0x37c17a[a2_0x2f09('0x9')]((_0xf89f69,_0x1ef3cf)=>_0xf89f69&&_0x1ef3cf,!![]));}}exports['CloudRemoteCache']=CloudRemoteCache;