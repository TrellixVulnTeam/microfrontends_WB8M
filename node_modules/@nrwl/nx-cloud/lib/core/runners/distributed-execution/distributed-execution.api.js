const a6_0x1c55=['response','message','next','axiosMultipleTries','error','../../../utilities/nx-imports','/nx-cloud/executions/complete-run-group','target','data','enabled','project','dteStatus','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','overrides','stopAgentsOnFailure','configuration','mapRespToPerfEntry','throw','/nx-cloud/executions/status','__esModule','post','getBranch','../../../utilities/axios','apiAxiosInstance','/nx-cloud/executions/start','RUNNER_FAILURE_PERF_ENTRY','createMetricRecorder','createApiAxiosInstance','start','value','map','DistributedExecutionApi','../../../utilities/metric-logger','axiosException','dteStart','apply','../../../utilities/environment','maxParallel','false','then','parallel','createStartRequest','completeRunGroupWithError','recordMetric','__awaiter','exit','status'];(function(_0x8dc40c,_0x1c5560){const _0x36e45c=function(_0x21b7d6){while(--_0x21b7d6){_0x8dc40c['push'](_0x8dc40c['shift']());}};_0x36e45c(++_0x1c5560);}(a6_0x1c55,0x89));const a6_0x36e4=function(_0x8dc40c,_0x1c5560){_0x8dc40c=_0x8dc40c-0x0;let _0x36e45c=a6_0x1c55[_0x8dc40c];return _0x36e45c;};'use strict';var __awaiter=this&&this[a6_0x36e4('0x4')]||function(_0x371b93,_0x2ec05b,_0x5e09b7,_0x2d2e17){function _0x1fc04a(_0x8e46ca){return _0x8e46ca instanceof _0x5e09b7?_0x8e46ca:new _0x5e09b7(function(_0x263781){_0x263781(_0x8e46ca);});}return new(_0x5e09b7||(_0x5e09b7=Promise))(function(_0x1aebd8,_0x1b4b8c){function _0x3ca303(_0x2813b3){try{_0x45edda(_0x2d2e17[a6_0x36e4('0x9')](_0x2813b3));}catch(_0x32550c){_0x1b4b8c(_0x32550c);}}function _0x5102b7(_0x341623){try{_0x45edda(_0x2d2e17[a6_0x36e4('0x19')](_0x341623));}catch(_0x402a8c){_0x1b4b8c(_0x402a8c);}}function _0x45edda(_0x2fa513){_0x2fa513['done']?_0x1aebd8(_0x2fa513[a6_0x36e4('0x25')]):_0x1fc04a(_0x2fa513[a6_0x36e4('0x25')])[a6_0x36e4('0x2f')](_0x3ca303,_0x5102b7);}_0x45edda((_0x2d2e17=_0x2d2e17[a6_0x36e4('0x2b')](_0x371b93,_0x2ec05b||[]))[a6_0x36e4('0x9')]());});};Object['defineProperty'](exports,a6_0x36e4('0x1b'),{'value':!![]});exports[a6_0x36e4('0x1')]=exports[a6_0x36e4('0x27')]=void 0x0;const axios_1=require(a6_0x36e4('0x1e'));const environment_1=require(a6_0x36e4('0x2c'));const metric_logger_1=require(a6_0x36e4('0x28'));const {output,unparse}=require(a6_0x36e4('0xc'));class DistributedExecutionApi{constructor(_0x449923){this[a6_0x36e4('0x1f')]=(0x0,axios_1[a6_0x36e4('0x23')])(_0x449923);}[a6_0x36e4('0x24')](_0x483d82){var _0x2191eb;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4f363c=(0x0,metric_logger_1[a6_0x36e4('0x22')])(a6_0x36e4('0x2a'));let _0x575201;try{_0x575201=yield(0x0,axios_1[a6_0x36e4('0xa')])(()=>this[a6_0x36e4('0x1f')][a6_0x36e4('0x1c')](a6_0x36e4('0x20'),_0x483d82));_0x4f363c[a6_0x36e4('0x3')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x575201));}catch(_0x584793){_0x4f363c[a6_0x36e4('0x3')](((_0x2191eb=_0x584793===null||_0x584793===void 0x0?void 0x0:_0x584793[a6_0x36e4('0x29')])===null||_0x2191eb===void 0x0?void 0x0:_0x2191eb['response'])?(0x0,metric_logger_1[a6_0x36e4('0x18')])(_0x584793['axiosException']['response']):metric_logger_1[a6_0x36e4('0x21')]);throw _0x584793;}if(!_0x575201[a6_0x36e4('0xf')][a6_0x36e4('0x10')]){throw new Error('Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.');}if(_0x575201['data'][a6_0x36e4('0xb')]){throw new Error(_0x575201[a6_0x36e4('0xf')][a6_0x36e4('0xb')]);}return _0x575201['data']['id'];});}[a6_0x36e4('0x6')](_0x273b17){var _0xab9bad;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1b85a6=(0x0,metric_logger_1[a6_0x36e4('0x22')])(a6_0x36e4('0x12'));try{const _0x1d9acf=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x36e4('0x1f')][a6_0x36e4('0x1c')](a6_0x36e4('0x1a'),{'id':_0x273b17}));_0x1b85a6[a6_0x36e4('0x3')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x1d9acf));return _0x1d9acf[a6_0x36e4('0xf')];}catch(_0x2f927c){_0x1b85a6['recordMetric'](((_0xab9bad=_0x2f927c===null||_0x2f927c===void 0x0?void 0x0:_0x2f927c['axiosException'])===null||_0xab9bad===void 0x0?void 0x0:_0xab9bad['response'])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x2f927c['axiosException']['response']):metric_logger_1[a6_0x36e4('0x21')]);output['error']({'title':_0x2f927c[a6_0x36e4('0x8')]});process[a6_0x36e4('0x5')](0x1);}});}[a6_0x36e4('0x2')](_0x2eabbb,_0x55bd52){var _0x424fa3;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x52be39=(0x0,metric_logger_1[a6_0x36e4('0x22')])('completeRunGroup');try{const _0x5b7b78=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x36e4('0x1f')][a6_0x36e4('0x1c')](a6_0x36e4('0xd'),{'runGroup':_0x2eabbb,'criticalErrorMessage':_0x55bd52}),0x3);_0x52be39[a6_0x36e4('0x3')]((0x0,metric_logger_1[a6_0x36e4('0x18')])(_0x5b7b78));}catch(_0x345d7c){_0x52be39['recordMetric'](((_0x424fa3=_0x345d7c===null||_0x345d7c===void 0x0?void 0x0:_0x345d7c['axiosException'])===null||_0x424fa3===void 0x0?void 0x0:_0x424fa3['response'])?(0x0,metric_logger_1[a6_0x36e4('0x18')])(_0x345d7c[a6_0x36e4('0x29')][a6_0x36e4('0x7')]):metric_logger_1[a6_0x36e4('0x21')]);}});}}exports[a6_0x36e4('0x27')]=DistributedExecutionApi;function createStartRequest(_0x1c3669,_0x3afd8b,_0x2f8f29){const _0x28f9dc=_0x3afd8b[a6_0x36e4('0x26')](_0x8b95f1=>{return _0x8b95f1[a6_0x36e4('0x26')](_0x1ad618=>{return{'taskId':_0x1ad618['id'],'hash':_0x1ad618['hash'],'projectName':_0x1ad618[a6_0x36e4('0xe')][a6_0x36e4('0x11')],'target':_0x1ad618[a6_0x36e4('0xe')][a6_0x36e4('0xe')],'configuration':_0x1ad618[a6_0x36e4('0xe')][a6_0x36e4('0x17')]||null,'params':unparse(_0x1ad618[a6_0x36e4('0x15')])['join']('\x20')};});});const _0x21f904={'command':(0x0,environment_1['parseCommand'])(),'branch':(0x0,environment_1[a6_0x36e4('0x1d')])(),'runGroup':_0x1c3669,'tasks':_0x28f9dc,'maxParallel':calculateMaxParallel(_0x2f8f29)};if(environment_1[a6_0x36e4('0x13')]){_0x21f904['agentCount']=environment_1[a6_0x36e4('0x13')];}if(!environment_1[a6_0x36e4('0x14')]){_0x21f904[a6_0x36e4('0x16')]=![];}return _0x21f904;}exports[a6_0x36e4('0x1')]=createStartRequest;function calculateMaxParallel(_0x411975){if(_0x411975['parallel']===a6_0x36e4('0x2e')||_0x411975['parallel']===![]){return 0x1;}else if(_0x411975['parallel']==='true'||_0x411975[a6_0x36e4('0x0')]===!![]){return Number(_0x411975[a6_0x36e4('0x2d')]||0x3);}else if(_0x411975[a6_0x36e4('0x0')]===undefined){return _0x411975[a6_0x36e4('0x2d')]?Number(_0x411975[a6_0x36e4('0x2d')]):0x3;}else{return Number(_0x411975[a6_0x36e4('0x0')])||0x3;}}